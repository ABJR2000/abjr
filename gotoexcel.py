import re
import pandas as pd

texto = """
MARTES 01/07 153 187 295 310 420 455 464 467 475 485 561
 MIÉRCOLES 02/07 126 200 234 365 400 415 418 453 461 477 509
 JUEVES 03/07 136 183 404 448 466 472 474 494 495 623 634
 VIERNES 04/07 105 106 195 289 435 457 509 520 525 613 625
 SABADO 05/07 106 115 145 160 185 322 365 368 398 401 405 408
 409 412 415 417 419 422 423 425 427 430 433 434
 435 449 457 470 473 474 476 511 609 612 613 618
 620 625 626
 DOMINGO 06/07 102 103 104 107 126 141 145 153 185 187 200 234
 295 310 345 358 368 371 373 374 375 400 402 403
 405 406 416 418 420 421 422 424 428 432 436 437
 438 440 445 447 450 451 454 455 456 459 463 464
 465 467 468 469 471 475 478 479 480 483 485 486
 493 494 496 497 498 499 510 515 517 532 551 556
 557 561 601 602 604 605 610 611 619 621 622 623
 627 628 631 633 634 636
 LUNES 07/07 183 185 374 447 448 453 461 472 477 520 611
 MARTES 08/07 115 136 289 320 376 379 423 466 609 619 626
 MIÉRCOLES 09/07 103 104 105 106 115 126 136 141 153 160 183 185
 187 195 200 234 289 295 310 320 322 345 358 365
 371 374 375 376 379 400 401 402 403 406 408 409
 412 415 416 419 420 421 423 425 427 428 430 432
 433 434 436 437 438 445 447 449 450 451 454 455
 457 459 463 464 466 468 469 473 474 476 478 479
 480 483 485 493 509 511 515 517 532 551 556 601
 604 605 609 611 612 613 618 620 622 623 625 626
 627 628 631 633 634 636 531
 JUEVES 10/07 365 406 408 417 421 432 450 486 532 557 610
 VIERNES 11/07 153 187 195 373 398 402 424 464 493 511 556
 SABADO 12/07 103 104 107 141 200 295 345 358 365 374 416 420
 428 437 440 445 447 453 465 467 468 471 472 476
 477 478 479 493 499 515 551 561 601 604 605 611
 628 631 636
 DOMINGO 13/07 102 103 106 115 126 136 145 160 183 185 234 289
 310 320 322 368 371 373 375 376 379 400 401 403
 404 405 406 409 412 415 418 419 421 422 423 425
 427 430 432 433 434 435 436 438 448 449 451 454
 455 456 459 457 461 463 466 469 470 473 474 475
 477 480 483 485 494 495 496 497 498 509 510 517
 520 525 532 602 609 612 613 618 619 620 621 622
 623 625 626 627 633 634
 LUNES 14/07 105 371 450 495 511 556 602 610 618 622 623
 MARTES 15/07 105 320 408 417 433 459 461 486 496 517 557
 MIÉRCOLES 16/07 195 345 368 398 401 416 424 468 483 497 498
 JUEVES 17/07 104 141 183 358 375 412 421 453 509 510 525
 VIERNES 18/07 136 404 415 427 435 440 454 466 469 551 627
 Día de la Independencia
 236 - Francos JULIO 2025 / FINALES
SABADO 19/07 105 107 160 234 310 322 400 403 404 405 409 416
 418 425 430 432 433 434 435 438 454 457 464 465
 472 474 475 479 480 483 494 515 532 602 609 613
 618 625 633
 DOMINGO 20/07 102 104 106 115 126 136 141 145 153 183 185 187
 195 200 289 295 320 345 358 365 371 373 374 375
 376 379 398 401 402 405 406 408 412 417 419 420
 421 423 428 437 445 447 448 450 451 455 456 459
 461 463 465 467 468 471 473 476 478 485 486 493
 495 496 497 498 499 509 510 511 517 520 525 556
 557 561 601 604 605 610 611 612 619 620 621 622
 623 626 628 631 634 636
 LUNES 21/07 103 115 153 320 409 422 424 425 427 430 436 437
 449 467 470 473 493 610 612 619 620 531
 MARTES 22/07 160 371 373 376 403 416 428 453 456 463 475 476
 478 479 551 557 601 604 605 628 631 636
 MIÉRCOLES 23/07 141 234 368 379 402 412 445 448 454 457 466 468
 469 474 477 480 515 556 613 621 625 633
 JUEVES 24/07 105 106 107 145 195 289 295 322 419 434 438 440
 450 451 455 496 499 511 517 532 609 618 408
 VIERNES 25/07 102 104 126 310 345 358 408 398 417 420 432 447
 449 459 473 494 509 510 612 620 622 634
 SABADO 26/07 104 187 200 345 358 365 374 375 401 403 406 423
 424 437 447 449 456 464 465 467 475 476 478 493
 495 499 510 561 604 605 611 612 619 620 622 623
 627 628 636
 DOMINGO 27/07 103 107 115 126 136 141 153 160 183 185 195 234
 289 295 320 322 368 371 376 379 398 400 402 403
 404 405 406 409 415 416 418 419 420 421 422 425
 427 428 430 433 434 435 436 438 440 445 448 449
 450 453 454 455 457 461 463 464 465 469 470 471
 472 474 477 479 480 483 485 486 494 495 496 498
 511 515 517 520 525 532 551 556 557 602 609 610
 613 618 625 627 631 633
 LUNES 28/07 102 106 107 379 402 412 428 436 451 459 466 468
 470 480 485 497 515 525 602 621 626 633
 MARTES 29/07 105 373 375 415 423 433 434 440 451 456 463 470
 471 473 476 478 486 497 551 601 626 631
 MIÉRCOLES 30/07 145 200 374 400 404 408 417 419 422 438 445 479
 498 499 561 601 604 605 611 627 628 634 636
 JUEVES 31/07 102 103 160 187 310 322 376 401 409 418 424 425
 427 430 432 436 437 469 471 472 483 520 621
"""

# Primero normalizamos saltos de línea para unir líneas partidas:
# Por ejemplo, unir líneas que no empiezan con día a la línea anterior

lineas = texto.splitlines()
lineas_unidas = []
buffer = ""

dias_semana = ["LUNES", "MARTES", "MIÉRCOLES", "JUEVES", "VIERNES", "SÁBADO", "DOMINGO"]

for linea in lineas:
    linea = linea.strip()
    if any(linea.startswith(dia) for dia in dias_semana):
        if buffer:
            lineas_unidas.append(buffer)
        buffer = linea
    else:
        buffer += " " + linea
if buffer:
    lineas_unidas.append(buffer)

# Ahora procesamos cada línea para extraer fecha y números
datos = []

for linea in lineas_unidas:
    # Extraer día y fecha con regex
    m = re.match(r"([A-ZÁÉÍÓÚ]+)\s+(\d{2}/\d{2})\s+(.*)", linea, re.IGNORECASE)
    if m:
        dia_semana = m.group(1)
        fecha_str = m.group(2)  # ej: 01/07
        numeros_str = m.group(3)
        
        # Convertir fecha a formato yyyy-mm-dd (podés ajustar el año)
        dia, mes = fecha_str.split("/")
        anio = "2025"
        fecha_formateada = f"{anio}-{mes.zfill(2)}-{dia.zfill(2)}"

        # Extraer números
        numeros = re.findall(r"\d+", numeros_str)
        for num in numeros:
            datos.append({"Fecha": fecha_formateada, "NumeroCoche": num})

# Crear dataframe
df = pd.DataFrame(datos)

# Guardar a Excel
df.to_excel("francos_julio.xlsx", index=False)
print("Archivo 'francos_julio.xlsx' creado correctamente.")
